import{d as f,r as v,x as d,y as l,I as p,z as t,J as h,K as k,L as $,M as b,A as _,N as w,o as S,B as g,O as C,P as N,_ as O}from"./B3i2eci4.js";const P={class:"flex items-center gap-2 pr-48"},U=f({__name:"PlayerForm",emits:["add-player"],setup(c,{emit:a}){const i=a,s=v("");function u(){s.value&&(i("add-player",{id:crypto.randomUUID(),name:s.value}),s.value="")}return(y,r)=>(l(),d(p,null,[r[1]||(r[1]=t("h2",{class:"text-lg font-bold"},"プレイヤー登録",-1)),t("div",P,[h(t("input",{class:"flex-1 border border-gray-300 rounded px-3 py-2 text-gray-900 placeholder-gray-400 input flex-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","onUpdate:modelValue":r[0]||(r[0]=n=>s.value=n)},null,512),[[k,s.value]]),t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 shrink-0",onClick:u},"追加")])],64))}}),V=Object.assign(U,{__name:"PlayerForm"}),B={class:"w-20 text-sm text-gray-700"},A=["onUpdate:modelValue"],F=f({__name:"RoundInput",props:{players:{}},emits:["add-round"],setup(c,{emit:a}){const i=c,s=a,u=$({}),y=()=>{let r=0;for(const e of i.players)r+=u[e.id]??0;if(r!==0){alert("点数の合計が 0 になるように入力してください");return}const n=[];for(const e of i.players){const o=u[e.id]??0;o!==0&&n.push({playerId:e.id,delta:o}),u[e.id]=0}n.length!==0&&s("add-round",n)};return(r,n)=>(l(),d(p,null,[n[0]||(n[0]=t("h2",{class:"text-lg font-bold"},"ラウンド追加",-1)),(l(!0),d(p,null,b(c.players,e=>(l(),d("div",{class:"flex items-center gap-3 py-1",key:e.id},[t("span",B,_(e.name),1),h(t("input",{type:"number",class:"w-24 border border-gray-300 rounded px-2 py-1 text-right focus:outline-none focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":o=>u[e.id]=o,placeholder:"点数変動"},null,8,A),[[k,u[e.id],void 0,{number:!0}]])]))),128)),t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:y},"このラウンドを確定")],64))}}),j=Object.assign(F,{__name:"RoundInput"}),D={class:"table-auto border border-gray-300 border-collapse"},E={class:"border px-2 py-1"},H={class:"border px-2 py-1"},J=["onClick"],M=f({__name:"RoundHistory",props:{players:{},rounds:{}},emits:["remove-round"],setup(c,{emit:a}){const i=c,s=a,u=r=>i.rounds.reduce((n,e)=>{const o=e.changes.find(m=>m.playerId===r);return n+(o?.delta??0)},0),y=r=>{confirm("このラウンドを削除しますか？")&&s("remove-round",r)};return(r,n)=>(l(),d(p,null,[n[4]||(n[4]=t("h2",{class:"text-lg font-bold"},"ラウンド結果",-1)),t("table",D,[t("thead",null,[t("tr",null,[n[0]||(n[0]=t("th",{class:"border px-2 py-1"},"Round",-1)),(l(!0),d(p,null,b(c.players,e=>(l(),d("th",{class:"border px-2 py-1",key:e.id},_(e.name),1))),128)),n[1]||(n[1]=t("th",{class:"border px-2 py-1"},null,-1))])]),t("tbody",null,[t("tr",null,[n[2]||(n[2]=t("td",{class:"font-black border px-2 py-1"},"合計",-1)),(l(!0),d(p,null,b(c.players,e=>(l(),d("td",{class:"font-black border px-2 py-1",key:e.id},_(u(e.id)),1))),128)),n[3]||(n[3]=t("td",null,null,-1))]),(l(!0),d(p,null,b(c.rounds,e=>(l(),d("tr",{key:e.id},[t("td",E,_(e.id),1),(l(!0),d(p,null,b(c.players,o=>(l(),d("td",{class:"border px-2 py-1",key:o.id},_(e.changes.find(m=>m.playerId===o.id)?.delta??0),1))),128)),t("td",H,[t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:o=>y(e.id)}," Undo ",8,J)])]))),128))])])],64))}}),K=Object.assign(M,{__name:"RoundHistory"}),L={class:"pt-8 pl-2 pr-2"},T={class:"pt-6"},z={class:"pt-6"},G={class:"pt-6"},x="score-game",Y=f({__name:"index",setup(c){const a=v([]),i=e=>{a.value.push(e)},s=v([]);let u=1;const y=e=>{s.value.push({id:u++,changes:e})},r=e=>{s.value=s.value.filter(o=>o.id!==e)};w([a,s],()=>{const e={players:a.value,rounds:s.value};localStorage.setItem(x,JSON.stringify(e))},{deep:!0}),S(()=>{const e=localStorage.getItem(x);if(e)try{const o=JSON.parse(e);a.value=o.players??[],s.value=o.rounds??[]}catch(o){console.error("localStorage の読み込みに失敗しました",o)}});function n(){confirm("データを削除しますか？")&&(localStorage.removeItem(x),a.value=[],s.value=[])}return(e,o)=>{const m=V,R=j,I=K;return l(),d("div",L,[o[0]||(o[0]=t("h1",{class:"text-xl font-bold"},"ドボン計算アプリ",-1)),t("div",T,[g(m,{players:a.value,onAddPlayer:i},null,8,["players"])]),t("div",z,[g(R,{players:a.value,onAddRound:y},null,8,["players"])]),t("div",G,[s.value.length?(l(),C(I,{key:0,players:a.value,rounds:s.value,onRemoveRound:r},null,8,["players","rounds"])):N("",!0)]),t("div",{class:"pt-6"},[t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:n},"全データリセット")])])}}}),Q=O(Y,[["__scopeId","data-v-e83de8a8"]]);export{Q as default};
