import{d as N,r as m,I as U,J as _,o as V,x as o,y as u,z as n,K as g,L as k,M as c,N as v,D as w,A as p,_ as D}from"./B75Ajvoy.js";const R={class:"page"},B=["onUpdate:modelValue"],E={border:"1",cellpadding:"6"},J=["onClick"],y="score-game",M=N({__name:"index",setup(O){const r=m([]),s=m("");function I(){s.value&&(r.value.push({id:crypto.randomUUID(),name:s.value}),s.value="")}const d=m([]);let b=1;const i=U({});function h(){let l=0;for(const t of r.value)l+=i[t.id]??0;if(l!==0){alert("点数の合計が 0 になるように入力してください");return}const e=[];for(const t of r.value){const a=i[t.id]??0;a!==0&&e.push({playerId:t.id,delta:a}),i[t.id]=0}e.length!==0&&d.value.push({id:b++,changes:e})}function S(l){return d.value.reduce((e,t)=>{const a=t.changes.find(f=>f.playerId===l);return e+(a?.delta??0)},0)}function x(l){confirm("このラウンドを削除しますか？")&&(d.value=d.value.filter(e=>e.id!==l))}_([r,d],()=>{const l={players:r.value,rounds:d.value};localStorage.setItem(y,JSON.stringify(l))},{deep:!0}),V(()=>{const l=localStorage.getItem(y);if(l)try{const e=JSON.parse(l);r.value=e.players??[],d.value=e.rounds??[]}catch(e){console.error("localStorage の読み込みに失敗しました",e)}});function C(){confirm("データを削除しますか？")&&(localStorage.removeItem(y),r.value=[],d.value=[])}return(l,e)=>(u(),o("main",R,[e[4]||(e[4]=n("h1",null,"ドボン計算アプリ",-1)),e[5]||(e[5]=n("h2",null,"プレイヤー登録",-1)),g(n("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.value=t),placeholder:"名前"},null,512),[[k,s.value]]),n("button",{onClick:I},"追加"),e[6]||(e[6]=n("h2",null,"ラウンド追加",-1)),(u(!0),o(c,null,v(r.value,t=>(u(),o("div",{key:t.id},[w(p(t.name)+" ",1),g(n("input",{type:"number","onUpdate:modelValue":a=>i[t.id]=a,placeholder:"点数変動"},null,8,B),[[k,i[t.id],void 0,{number:!0}]])]))),128)),n("button",{onClick:h},"このラウンドを確定"),e[7]||(e[7]=n("h2",null,"ラウンド結果",-1)),n("table",E,[n("thead",null,[n("tr",null,[e[1]||(e[1]=n("th",null,"Round",-1)),(u(!0),o(c,null,v(r.value,t=>(u(),o("th",{key:t.id},p(t.name),1))),128))])]),n("tbody",null,[n("tr",null,[e[2]||(e[2]=n("td",null,"合計",-1)),(u(!0),o(c,null,v(r.value,t=>(u(),o("td",{key:t.id},p(S(t.id)),1))),128)),e[3]||(e[3]=n("td",null,null,-1))]),(u(!0),o(c,null,v(d.value,t=>(u(),o("tr",{key:t.id},[n("td",null,p(t.id),1),(u(!0),o(c,null,v(r.value,a=>(u(),o("td",{key:a.id},p(t.changes.find(f=>f.playerId===a.id)?.delta??0),1))),128)),n("td",null,[n("button",{onClick:a=>x(t.id)}," Undo ",8,J)])]))),128))])]),n("button",{onClick:C},"全データリセット")]))}}),A=D(M,[["__scopeId","data-v-b526c455"]]);export{A as default};
