import{d as f,r as x,x as a,y as u,I as p,z as t,J as h,K as R,L as w,M as b,D as S,A as _,N as C,o as N,B as v,_ as O}from"./DKy-6EuY.js";const U=f({__name:"PlayerForm",emits:["add-player"],setup(c,{emit:s}){const i=s,r=x("");function d(){r.value&&(i("add-player",{id:crypto.randomUUID(),name:r.value}),r.value="")}return(y,l)=>(u(),a(p,null,[l[1]||(l[1]=t("h2",null,"プレイヤー登録",-1)),h(t("input",{class:"w-full border border-gray-300 rounded px-3 py-2 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","onUpdate:modelValue":l[0]||(l[0]=n=>r.value=n)},null,512),[[R,r.value]]),t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:d},"追加")],64))}}),V=Object.assign(U,{__name:"PlayerForm"}),$=["onUpdate:modelValue"],P=f({__name:"RoundInput",props:{players:{}},emits:["add-round"],setup(c,{emit:s}){const i=c,r=s,d=w({}),y=()=>{let l=0;for(const e of i.players)l+=d[e.id]??0;if(l!==0){alert("点数の合計が 0 になるように入力してください");return}const n=[];for(const e of i.players){const o=d[e.id]??0;o!==0&&n.push({playerId:e.id,delta:o}),d[e.id]=0}n.length!==0&&r("add-round",n)};return(l,n)=>(u(),a(p,null,[n[0]||(n[0]=t("h2",null,"ラウンド追加",-1)),(u(!0),a(p,null,b(c.players,e=>(u(),a("div",{key:e.id},[S(_(e.name)+" ",1),h(t("input",{type:"number",class:"w-24 border border-gray-300 rounded px-2 py-1 text-right focus:outline-none focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":o=>d[e.id]=o,placeholder:"点数変動"},null,8,$),[[R,d[e.id],void 0,{number:!0}]])]))),128)),t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:y},"このラウンドを確定")],64))}}),A=Object.assign(P,{__name:"RoundInput"}),B={class:"table-auto border border-gray-300 border-collapse"},D={class:"border px-2 py-1"},F={class:"border px-2 py-1"},j=["onClick"],E=f({__name:"RoundHistory",props:{players:{},rounds:{}},emits:["remove-round"],setup(c,{emit:s}){const i=c,r=s,d=l=>i.rounds.reduce((n,e)=>{const o=e.changes.find(m=>m.playerId===l);return n+(o?.delta??0)},0),y=l=>{confirm("このラウンドを削除しますか？")&&r("remove-round",l)};return(l,n)=>(u(),a(p,null,[n[4]||(n[4]=t("h2",null,"ラウンド結果",-1)),t("table",B,[t("thead",null,[t("tr",null,[n[0]||(n[0]=t("th",{class:"border px-2 py-1"},"Round",-1)),(u(!0),a(p,null,b(c.players,e=>(u(),a("th",{class:"border px-2 py-1",key:e.id},_(e.name),1))),128)),n[1]||(n[1]=t("th",{class:"border px-2 py-1"},null,-1))])]),t("tbody",null,[t("tr",null,[n[2]||(n[2]=t("td",{class:"font-black border px-2 py-1"},"合計",-1)),(u(!0),a(p,null,b(c.players,e=>(u(),a("td",{class:"font-black border px-2 py-1",key:e.id},_(d(e.id)),1))),128)),n[3]||(n[3]=t("td",null,null,-1))]),(u(!0),a(p,null,b(c.rounds,e=>(u(),a("tr",{key:e.id},[t("td",D,_(e.id),1),(u(!0),a(p,null,b(c.players,o=>(u(),a("td",{class:"border px-2 py-1",key:o.id},_(e.changes.find(m=>m.playerId===o.id)?.delta??0),1))),128)),t("td",F,[t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:o=>y(e.id)}," Undo ",8,j)])]))),128))])])],64))}}),H=Object.assign(E,{__name:"RoundHistory"}),J={class:"page"},g="score-game",M=f({__name:"index",setup(c){const s=x([]),i=e=>{s.value.push(e)},r=x([]);let d=1;const y=e=>{r.value.push({id:d++,changes:e})},l=e=>{r.value=r.value.filter(o=>o.id!==e)};C([s,r],()=>{const e={players:s.value,rounds:r.value};localStorage.setItem(g,JSON.stringify(e))},{deep:!0}),N(()=>{const e=localStorage.getItem(g);if(e)try{const o=JSON.parse(e);s.value=o.players??[],r.value=o.rounds??[]}catch(o){console.error("localStorage の読み込みに失敗しました",o)}});function n(){confirm("データを削除しますか？")&&(localStorage.removeItem(g),s.value=[],r.value=[])}return(e,o)=>{const m=V,k=A,I=H;return u(),a("main",J,[o[0]||(o[0]=t("h1",null,"ドボン計算アプリ",-1)),v(m,{players:s.value,onAddPlayer:i},null,8,["players"]),v(k,{players:s.value,onAddRound:y},null,8,["players"]),v(I,{players:s.value,rounds:r.value,onRemoveRound:l},null,8,["players","rounds"]),t("button",{onClick:n},"全データリセット")])}}}),K=O(M,[["__scopeId","data-v-09b9cf35"]]);export{K as default};
